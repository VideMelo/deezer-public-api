!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i(require("undici"),require("node:http")):"function"==typeof define&&define.amd?define(["undici","node:http"],i):(t||self).deezerPublicApi=i(t.undici,t.http)}(this,function(t,i){function r(t){if(t&&t.__esModule)return t;var i=Object.create(null);return t&&Object.keys(t).forEach(function(r){if("default"!==r){var e=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(i,r,e.get?e:{enumerable:!0,get:function(){return t[r]}})}}),i.default=t,i}var e=/*#__PURE__*/r(i),n=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var i=t.prototype;return i.all=function(t){var i,r=t.query,e=t.order,n=t.limit,s=t.index,o=t.strict;return i="object"==typeof r?Object.entries(r).map(function(t){return t[0]+':"'+t[1]+'"'}).join(""):r,this.api.request({uri:"search",query:i,strict:o,order:e,index:s,limit:n})},i.album=function(t){return this.api.request({uri:"search/album",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},i.artist=function(t){return this.api.request({uri:"search/artist",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},i.playlist=function(t){return this.api.request({uri:"search/playlist",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},i.podcast=function(t){return this.api.request({uri:"search/podcast",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},i.radio=function(t){return this.api.request({uri:"search/radio",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},i.track=function(t){return this.api.request({uri:"search/track",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},i.user=function(t){return this.api.request({uri:"search/user",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},t}(),s=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}return t.prototype.get=function(t){return this.api.request({uri:"track/"+t.id})},t}(),o=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var i=t.prototype;return i.get=function(t){return this.api.request({uri:"album/"+t.id})},i.fans=function(t){return this.api.request({uri:"album/"+t.id+"/fans"})},i.tracks=function(t){return this.api.request({uri:"album/"+t.id+"/fans"})},t}(),u=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var i=t.prototype;return i.get=function(t){return this.api.request({uri:"artist/"+t.id})},i.top=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},i.albums=function(t){return this.api.request({uri:"albums/"+t.id+"/top"})},i.fans=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},i.related=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},i.radio=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},i.playlist=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},t}();function a(){return a=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])}return t},a.apply(this,arguments)}var c=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var i=t.prototype;return i.setup=function(t){var i=t.perms;this.api.config=a({},this.api.config,{appId:t.appId,redirectUri:t.redirectUri,perms:"string"==typeof i?[i]:i})},i.getLoginUrl=function(){var t;if(!this.api.config.appId||!this.api.config.redirectUri)throw new Error("auth.setup(opts: { appId: string, redirectUri: string, perms?: string | string[] }) should be called before auth.getLoginUrl");var i=new URL("https://connect.deezer.com/oauth/auth.php");return i.searchParams.set("app_id",this.api.config.appId),i.searchParams.set("redirect_uri",this.api.config.redirectUri),i.searchParams.set("perms",(null!=(t=this.api.config.perms)?t:[]).join(",")),i.toString()},i.waitForLoginCallback=function(){var t=this;return new Promise(function(i){if(!t.api.config.appId||!t.api.config.redirectUri)throw new Error("auth.setup(opts: { appId: string, redirectUri: string, perms?: string | string[] }) should be called before auth.getLoginUrl");var r=new URL(t.api.config.redirectUri),n=e.createServer(function(t,e){var s,o=new URL(null!=(s=t.url)?s:"/","http://"+t.headers.host);o.pathname===r.pathname&&o.searchParams.has("code")&&(i({code:o.searchParams.get("code")}),e.writeHead(200,{"Content-Type":"text/html"}).end('<html><body><div style="display: grid; place-content: center; font-family: sans-serif"><h1>Auth code received</h1><p>You can close this window and get back to your terminal</p></div></body></html>'),n.close(function(){console.log("closed")}))});n.listen(r.port)})},t}();/*#__PURE__*/
return function(){function i(){this.auth=new c(this),this.search=new n(this),this.track=new s(this),this.album=new o(this),this.artist=new u(this),this.deezerApiBaseUrl="https://api.deezer.com/",this.config={}}return i.prototype.request=function(i){var r=i.uri,e=i.index,n=i.limit,s=i.order,o=i.strict,u=i.query;try{var a=new URL(r,this.deezerApiBaseUrl),c=function(t,i){return void 0!==i?a.searchParams.set(t,String(i)):void 0};return c("q",u),c("index",e),c("limit",n),c("order",s),c("strict",o?"on":void 0),console.log(a.toString(),{uri:r,index:e,limit:n,order:s,strict:o,query:u}),Promise.resolve(t.request(a)).then(function(t){return t.body.json()})}catch(t){return Promise.reject(t)}},i}()});
//# sourceMappingURL=deezer-public-api.umd.js.map
