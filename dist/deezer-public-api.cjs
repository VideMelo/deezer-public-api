var t=require("undici");function r(t){if(t&&t.__esModule)return t;var r=Object.create(null);return t&&Object.keys(t).forEach(function(i){if("default"!==i){var e=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,e.get?e:{enumerable:!0,get:function(){return t[i]}})}}),r.default=t,r}var i=/*#__PURE__*/r(require("node:http")),e=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var r=t.prototype;return r.all=function(t){var r,i=t.query,e=t.order,n=t.limit,s=t.index,u=t.strict;return r="object"==typeof i?Object.entries(i).map(function(t){return t[0]+':"'+t[1]+'"'}).join(""):i,this.api.request({uri:"search",query:r,strict:u,order:e,index:s,limit:n})},r.album=function(t){return this.api.request({uri:"search/album",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.artist=function(t){return this.api.request({uri:"search/artist",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.playlist=function(t){return this.api.request({uri:"search/playlist",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.podcast=function(t){return this.api.request({uri:"search/podcast",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.radio=function(t){return this.api.request({uri:"search/radio",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.track=function(t){return this.api.request({uri:"search/track",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.user=function(t){return this.api.request({uri:"search/user",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},t}(),n=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}return t.prototype.get=function(t){return this.api.request({uri:"track/"+t.id})},t}(),s=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var r=t.prototype;return r.get=function(t){return this.api.request({uri:"album/"+t.id})},r.fans=function(t){return this.api.request({uri:"album/"+t.id+"/fans"})},r.tracks=function(t){return this.api.request({uri:"album/"+t.id+"/fans"})},t}(),u=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var r=t.prototype;return r.get=function(t){return this.api.request({uri:"artist/"+t.id})},r.top=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},r.albums=function(t){return this.api.request({uri:"albums/"+t.id+"/top"})},r.fans=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},r.related=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},r.radio=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},r.playlist=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},t}();function o(){return o=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])}return t},o.apply(this,arguments)}var a=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var r=t.prototype;return r.setup=function(t){var r=t.perms;this.api.config=o({},this.api.config,{appId:t.appId,redirectUri:t.redirectUri,perms:"string"==typeof r?[r]:r})},r.getLoginUrl=function(){var t;if(!this.api.config.appId||!this.api.config.redirectUri)throw new Error("auth.setup(opts: { appId: string, redirectUri: string, perms?: string | string[] }) should be called before auth.getLoginUrl");var r=new URL("https://connect.deezer.com/oauth/auth.php");return r.searchParams.set("app_id",this.api.config.appId),r.searchParams.set("redirect_uri",this.api.config.redirectUri),r.searchParams.set("perms",(null!=(t=this.api.config.perms)?t:[]).join(",")),r.toString()},r.waitForLoginCallback=function(){var t=this;return new Promise(function(r){if(!t.api.config.appId||!t.api.config.redirectUri)throw new Error("auth.setup(opts: { appId: string, redirectUri: string, perms?: string | string[] }) should be called before auth.getLoginUrl");var e=new URL(t.api.config.redirectUri),n=i.createServer(function(t,i){var s,u=new URL(null!=(s=t.url)?s:"/","http://"+t.headers.host);u.pathname===e.pathname&&u.searchParams.has("code")&&(r({code:u.searchParams.get("code")}),i.writeHead(200,{"Content-Type":"text/html"}).end('<html><body><div style="display: grid; place-content: center; font-family: sans-serif"><h1>Auth code received</h1><p>You can close this window and get back to your terminal</p></div></body></html>'),n.close(function(){console.log("closed")}))});n.listen(e.port)})},t}();module.exports=/*#__PURE__*/function(){function r(){this.auth=new a(this),this.search=new e(this),this.track=new n(this),this.album=new s(this),this.artist=new u(this),this.deezerApiBaseUrl="https://api.deezer.com/",this.config={}}return r.prototype.request=function(r){var i=r.uri,e=r.index,n=r.limit,s=r.order,u=r.strict,o=r.query;try{var a=new URL(i,this.deezerApiBaseUrl),c=function(t,r){return void 0!==r?a.searchParams.set(t,String(r)):void 0};return c("q",o),c("index",e),c("limit",n),c("order",s),c("strict",u?"on":void 0),console.log(a.toString(),{uri:i,index:e,limit:n,order:s,strict:u,query:o}),Promise.resolve(t.request(a)).then(function(t){return t.body.json()})}catch(t){return Promise.reject(t)}},r}();
//# sourceMappingURL=deezer-public-api.cjs.map
