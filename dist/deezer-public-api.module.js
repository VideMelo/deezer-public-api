import{request as t}from"undici";import*as r from"node:http";var i=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var r=t.prototype;return r.all=function(t){var r,i=t.query,e=t.order,n=t.limit,s=t.index,o=t.strict;return r="object"==typeof i?Object.entries(i).map(function(t){return t[0]+':"'+t[1]+'"'}).join(""):i,this.api.request({uri:"search",query:r,strict:o,order:e,index:s,limit:n})},r.album=function(t){return this.api.request({uri:"search/album",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.artist=function(t){return this.api.request({uri:"search/artist",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.playlist=function(t){return this.api.request({uri:"search/playlist",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.podcast=function(t){return this.api.request({uri:"search/podcast",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.radio=function(t){return this.api.request({uri:"search/radio",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.track=function(t){return this.api.request({uri:"search/track",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},r.user=function(t){return this.api.request({uri:"search/user",query:t.query,strict:t.strict,order:t.order,index:t.index,limit:t.limit})},t}(),e=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}return t.prototype.get=function(t){return this.api.request({uri:"track/"+t.id})},t}(),n=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var r=t.prototype;return r.get=function(t){return this.api.request({uri:"album/"+t.id})},r.fans=function(t){return this.api.request({uri:"album/"+t.id+"/fans"})},r.tracks=function(t){return this.api.request({uri:"album/"+t.id+"/fans"})},t}(),s=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var r=t.prototype;return r.get=function(t){return this.api.request({uri:"artist/"+t.id})},r.top=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},r.albums=function(t){return this.api.request({uri:"albums/"+t.id+"/top"})},r.fans=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},r.related=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},r.radio=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},r.playlist=function(t){return this.api.request({uri:"artist/"+t.id+"/top"})},t}();function o(){return o=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])}return t},o.apply(this,arguments)}var a=/*#__PURE__*/function(){function t(t){this.api=void 0,this.api=t}var i=t.prototype;return i.setup=function(t){var r=t.perms;this.api.config=o({},this.api.config,{appId:t.appId,redirectUri:t.redirectUri,perms:"string"==typeof r?[r]:r})},i.getLoginUrl=function(){var t;if(!this.api.config.appId||!this.api.config.redirectUri)throw new Error("auth.setup(opts: { appId: string, redirectUri: string, perms?: string | string[] }) should be called before auth.getLoginUrl");var r=new URL("https://connect.deezer.com/oauth/auth.php");return r.searchParams.set("app_id",this.api.config.appId),r.searchParams.set("redirect_uri",this.api.config.redirectUri),r.searchParams.set("perms",(null!=(t=this.api.config.perms)?t:[]).join(",")),r.toString()},i.waitForLoginCallback=function(){var t=this;return new Promise(function(i){if(!t.api.config.appId||!t.api.config.redirectUri)throw new Error("auth.setup(opts: { appId: string, redirectUri: string, perms?: string | string[] }) should be called before auth.getLoginUrl");var e=new URL(t.api.config.redirectUri),n=r.createServer(function(t,r){var s,o=new URL(null!=(s=t.url)?s:"/","http://"+t.headers.host);o.pathname===e.pathname&&o.searchParams.has("code")&&(i({code:o.searchParams.get("code")}),r.writeHead(200,{"Content-Type":"text/html"}).end('<html><body><div style="display: grid; place-content: center; font-family: sans-serif"><h1>Auth code received</h1><p>You can close this window and get back to your terminal</p></div></body></html>'),n.close(function(){console.log("closed")}))});n.listen(e.port)})},t}(),u=/*#__PURE__*/function(){function r(){this.auth=new a(this),this.search=new i(this),this.track=new e(this),this.album=new n(this),this.artist=new s(this),this.deezerApiBaseUrl="https://api.deezer.com/",this.config={}}return r.prototype.request=function(r){var i=r.uri,e=r.index,n=r.limit,s=r.order,o=r.strict,a=r.query;try{var u=new URL(i,this.deezerApiBaseUrl),c=function(t,r){return void 0!==r?u.searchParams.set(t,String(r)):void 0};return c("q",a),c("index",e),c("limit",n),c("order",s),c("strict",o?"on":void 0),console.log(u.toString(),{uri:i,index:e,limit:n,order:s,strict:o,query:a}),Promise.resolve(t(u)).then(function(t){return t.body.json()})}catch(t){return Promise.reject(t)}},r}();export{u as default};
//# sourceMappingURL=deezer-public-api.module.js.map
